<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="theme-color" content="#2C5F47">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Cookie Policy - Mental Commons</title>
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.svg">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.svg">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/style.css?v=2025062701">
    
    <!-- Sistema di logging minimo e ottimizzato -->
    <script>
        window.isProduction = location.hostname !== 'localhost' && !location.hostname.includes('local');
        const log = (...args) => { if (!window.isProduction) console.log(...args); };
        
        // Controllo auth ultrarapido
        try {
            const token = localStorage.getItem('mental_commons_token');
            const userJson = localStorage.getItem('mental_commons_user');
            const html = document.documentElement;
            
            if (token && userJson) {
                try {
                    const payload = JSON.parse(atob(token.split('.')[1]));
                    const now = Math.floor(Date.now() / 1000);
                    
                    if (now < payload.exp - 300) {
                        html.className = 'auth-ready user-authenticated';
                        window.immediateAuthState = {
                            isAuthenticated: true,
                            user: JSON.parse(userJson),
                            verified: true
                        };
                        log('‚úÖ Auth: utente autenticato');
                    } else {
                        localStorage.removeItem('mental_commons_token');
                        localStorage.removeItem('mental_commons_user');
                        html.className = 'auth-ready user-guest';
                        window.immediateAuthState = { isAuthenticated: false, user: null, verified: true };
                        log('‚è∞ Auth: token scaduto');
                    }
                } catch (e) {
                    localStorage.removeItem('mental_commons_token');
                    localStorage.removeItem('mental_commons_user');
                    html.className = 'auth-ready user-guest';
                    window.immediateAuthState = { isAuthenticated: false, user: null, verified: true };
                    log('‚ö†Ô∏è Auth: parsing error');
                }
            } else {
                html.className = 'auth-ready user-guest';
                window.immediateAuthState = { isAuthenticated: false, user: null, verified: true };
                log('üë§ Auth: guest user');
            }
        } catch (error) {
            document.documentElement.className = 'auth-ready user-guest';
            window.immediateAuthState = { isAuthenticated: false, user: null, verified: true, error: error.message };
            console.error('‚ùå Auth error:', error);
        }
    </script>
    <script type="module" src="/api/env.js"></script>
    <style>
      body {
        display: flex;
        flex-direction: column;
        min-height: 100vh;
      }
      .site-footer {
        margin-top: auto;
        flex-shrink: 0;
      }
      .lang-en { display: none; }
      html[lang="en"] .lang-en { display: block; }
      html[lang="en"] .lang-it { display: none; }
    </style>
</head>
<body class="cookie-policy-page">
    <script defer src="/scripts/i18n.runtime.js"></script>
    <script defer src="/scripts/lang-toggle-footer.js"></script>
    <!-- Top Navigation Container -->
    <header class="top-navigation-container">
        <a href="index.html" class="nav-logo"><img src="/logo.svg" alt="Mental Commons" /></a>
        
        <!-- Navigazione principale -->
        <nav class="nav-main">
            <a href="index.html" data-i18n="nav.home"></a>
            <a href="come-funziona.html" data-i18n="nav.how_it_works"></a>
            <a href="mc-per-le-scuole.html" data-i18n="nav.schools"></a>
            <a href="premium.html" data-i18n="nav.premium"></a>
        </nav>

        <!-- Azioni utente -->
        <div class="nav-actions">
            <a href="dashboard.html" id="nav-dashboard" style="display: none;" data-i18n="nav.dashboard"></a>
            <a href="admin.html" id="nav-admin" style="display: none;" data-i18n="nav.admin"></a>
            <a href="login.html" id="nav-login" data-i18n="nav.login"></a>
            <a href="profile.html" id="nav-profile" class="nav-profile-btn" style="display: none;" title="Gestione Profilo" aria-label="Gestione Profilo">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                    <circle cx="12" cy="7" r="4"></circle>
                </svg>
            </a>
        </div>
    </header>

    <main class="cookie-content lang-it">
        <div class="container">
            <h1 data-i18n="legal.cookie.title"></h1>
            <p class="cookie-date" data-i18n="legal.cookie.updated"></p>

            <section class="cookie-section">
                <h2>Introduzione</h2>
                <p>Mental Commons utilizza esclusivamente cookie e tecnologie simili strettamente necessari al funzionamento sicuro e responsabile della piattaforma. Non effettuiamo tracciamenti pubblicitari n√© profilazione dell'utente. Questa Cookie Policy descrive le tipologie di cookie utilizzati, la loro funzione e il modo in cui vengono gestiti.</p>
            </section>

            <section class="cookie-section">
                <h2>1. Cookie di sessione (Backend)</h2>
                <p><strong>Nome:</strong> <code>mc_session</code></p>
                <p><strong>Scopo:</strong> Gestione dell'autenticazione sicura lato server</p>
                <p><strong>Caratteristiche:</strong></p>
                <ul>
                    <li>httpOnly: true (non accessibile da JavaScript)</li>
                    <li>secure: true (attivo solo su HTTPS)</li>
                    <li>sameSite: 'strict' (protezione contro attacchi CSRF)</li>
                    <li>maxAge: 30 minuti</li>
                    <li>path: '/'</li>
                </ul>
            </section>

            <section class="cookie-section">
                <h2>2. LocalStorage (Frontend)</h2>
                <p>Mental Commons utilizza lo storage locale del browser per mantenere lo stato utente.</p>
                <ul>
                    <li><code>mental_commons_token</code>: Token JWT per l'autenticazione</li>
                    <li><code>mental_commons_user</code>: Dati utente serializzati in JSON</li>
                </ul>
                <p>Questi dati non sono condivisi con terze parti e vengono gestiti localmente.</p>
            </section>

            <section class="cookie-section">
                <h2>3. Cookie di terze parti</h2>
                
                <h3>Stripe</h3>
                <ul>
                    <li><strong>Origine:</strong> <code>https://js.stripe.com/v3/</code></li>
                    <li><strong>Scopo:</strong> Gestione dei pagamenti e del checkout</li>
                    <li><strong>Tipi:</strong> Cookie di sessione e preferenze temporanee</li>
                </ul>

                <h3>Supabase</h3>
                <ul>
                    <li><strong>Origine:</strong> <code>https://*.supabase.co</code></li>
                    <li><strong>Scopo:</strong> Connessione sicura al database e autenticazione</li>
                    <li><strong>Note:</strong> <code>autoRefreshToken: false</code>, <code>persistSession: false</code></li>
                </ul>

                <h3>Google Fonts</h3>
                <ul>
                    <li><strong>Origine:</strong> <code>https://fonts.googleapis.com</code>, <code>https://fonts.gstatic.com</code></li>
                    <li><strong>Scopo:</strong> Caricamento font tipografici</li>
                    <li><strong>Tipi:</strong> Cookie tecnici di cache</li>
                </ul>

                <h3>Unpkg (CDN)</h3>
                <ul>
                    <li><strong>Origine:</strong> <code>https://unpkg.com</code></li>
                    <li><strong>Scopo:</strong> Caricamento librerie JavaScript</li>
                    <li><strong>Tipi:</strong> Cookie di cache, non profilanti</li>
                </ul>
            </section>

            <section class="cookie-section">
                <h2>4. Cookie di Analytics</h2>
                <p>Attualmente non utilizziamo strumenti attivi di tracciamento come Google Analytics. La libreria Vercel Analytics √® installata ma <strong>non configurata</strong> attivamente. Nessun dato personale viene raccolto o condiviso a fini statistici.</p>
            </section>

            <section class="cookie-section">
                <h2>5. Configurazioni di sicurezza</h2>
                <p>Mental Commons implementa una <strong>Content Security Policy (CSP)</strong> rigorosa che limita:</p>
                <ul>
                    <li><strong>Script:</strong> solo da 'self', 'unsafe-inline', <code>https://unpkg.com</code></li>
                    <li><strong>Connessioni:</strong> solo verso 'self', <code>https://*.supabase.co</code>, <code>wss://*.supabase.co</code></li>
                    <li><strong>Font:</strong> solo da Google Fonts</li>
                    <li><strong>Immagini:</strong> solo da 'self' e data:</li>
                </ul>
            </section>

            <section class="cookie-section">
                <h2>6. Gestione dei cookie</h2>
                <ul>
                    <li><strong>Rotazione automatica:</strong> Le sessioni vengono aggiornate ogni 15 minuti</li>
                    <li><strong>Timeout:</strong> Inattivit√† superiore a 30 minuti comporta logout automatico</li>
                    <li><strong>Limite:</strong> Massimo 5 sessioni attive per utente</li>
                    <li><strong>Pulizia:</strong> Cookie scaduti rimossi automaticamente</li>
                </ul>
            </section>

            <section class="cookie-section">
                <h2>7. Scelte dell'utente</h2>
                <p>Non essendo presenti cookie non essenziali, non √® richiesto un banner per la richiesta di consenso. L'utilizzo del sito implica l'accettazione dell'uso di cookie tecnici minimi e necessari.</p>
            </section>

            <section class="cookie-section">
                <h2>8. Contatti</h2>
                <p>Per ulteriori informazioni: <a href="mailto:comunicazioni@mentalcommons.xyz">comunicazioni@mentalcommons.xyz</a></p>
            </section>

            <div class="cookie-note">
                <p>Questo sito crede nella privacy radicale: niente sorprese, niente pubblicit√†, niente dati in giro. Solo ci√≤ che serve per far funzionare la piattaforma, in modo sicuro e rispettoso.</p>
            </div>
        </div>
    </main>

    <!-- English version -->
    <section class="cookie-content lang-en">
      <div class="container">
        <h1>Mental Commons Cookie Policy</h1>
        <p class="cookie-date">Last updated: 7 August 2025</p>

        <section class="cookie-section">
          <h2>Introduction</h2>
          <p>Mental Commons uses only cookies and similar technologies that are strictly necessary for safe and responsible operation of the platform. We do not perform advertising tracking or user profiling. This Cookie Policy describes the types of cookies used, their function and how they are managed.</p>
        </section>

        <section class="cookie-section">
          <h2>1. Session Cookie (Backend)</h2>
          <p><strong>Name:</strong> <code>mc_session</code></p>
          <p><strong>Purpose:</strong> Secure server-side authentication management</p>
          <p><strong>Characteristics:</strong></p>
          <ul>
            <li>httpOnly: true (not accessible via JavaScript)</li>
            <li>secure: true (HTTPS only)</li>
            <li>sameSite: 'strict' (CSRF protection)</li>
            <li>maxAge: 30 minutes</li>
            <li>path: '/'</li>
          </ul>
        </section>

        <section class="cookie-section">
          <h2>2. LocalStorage (Frontend)</h2>
          <p>Mental Commons uses the browser's local storage to maintain user state.</p>
          <ul>
            <li><code>mental_commons_token</code>: JWT token for authentication</li>
            <li><code>mental_commons_user</code>: User data serialized in JSON</li>
          </ul>
          <p>These data are not shared with third parties and are handled locally.</p>
        </section>

        <section class="cookie-section">
          <h2>3. Third-party Cookies</h2>
          <h3>Stripe</h3>
          <ul>
            <li><strong>Origin:</strong> <code>https://js.stripe.com/v3/</code></li>
            <li><strong>Purpose:</strong> Managing payments and checkout</li>
            <li><strong>Types:</strong> Session cookies and temporary preferences</li>
          </ul>
          <h3>Supabase</h3>
          <ul>
            <li><strong>Origin:</strong> <code>https://*.supabase.co</code></li>
            <li><strong>Purpose:</strong> Secure database connection and authentication</li>
            <li><strong>Notes:</strong> <code>autoRefreshToken: false</code>, <code>persistSession: false</code></li>
          </ul>
          <h3>Google Fonts</h3>
          <ul>
            <li><strong>Origin:</strong> <code>https://fonts.googleapis.com</code>, <code>https://fonts.gstatic.com</code></li>
            <li><strong>Purpose:</strong> Loading web fonts</li>
            <li><strong>Types:</strong> Technical cache cookies</li>
          </ul>
          <h3>Unpkg (CDN)</h3>
          <ul>
            <li><strong>Origin:</strong> <code>https://unpkg.com</code></li>
            <li><strong>Purpose:</strong> Loading JavaScript libraries</li>
            <li><strong>Types:</strong> Cache cookies, not profiling</li>
          </ul>
        </section>

        <section class="cookie-section">
          <h2>4. Analytics Cookies</h2>
          <p>We currently do not use active tracking tools like Google Analytics. The Vercel Analytics library is installed but <strong>not actively configured</strong>. No personal data are collected or shared for statistics.</p>
        </section>

        <section class="cookie-section">
          <h2>5. Security Configurations</h2>
          <p>Mental Commons implements a <strong>strict Content Security Policy (CSP)</strong> that limits:</p>
          <ul>
            <li><strong>Scripts:</strong> only from 'self', 'unsafe-inline', <code>https://unpkg.com</code></li>
            <li><strong>Connections:</strong> only to 'self', <code>https://*.supabase.co</code>, <code>wss://*.supabase.co</code></li>
            <li><strong>Fonts:</strong> only from Google Fonts</li>
            <li><strong>Images:</strong> only from 'self' and data:</li>
          </ul>
        </section>

        <section class="cookie-section">
          <h2>6. Cookie Management</h2>
          <ul>
            <li><strong>Automatic rotation:</strong> Sessions are refreshed every 15 minutes</li>
            <li><strong>Timeout:</strong> Inactivity over 30 minutes triggers automatic logout</li>
            <li><strong>Limit:</strong> Maximum 5 active sessions per user</li>
            <li><strong>Cleanup:</strong> Expired cookies are removed automatically</li>
          </ul>
        </section>

        <section class="cookie-section">
          <h2>7. User Choices</h2>
          <p>Because no non-essential cookies are present, no consent banner is required. Using the site implies acceptance of minimal technical cookies necessary for operation.</p>
        </section>

        <section class="cookie-section">
          <h2>8. Contacts</h2>
          <p>For further information: <a href="mailto:comunicazioni@mentalcommons.xyz">comunicazioni@mentalcommons.xyz</a></p>
        </section>

        <div class="cookie-note">
          <p>This site believes in radical privacy: no surprises, no ads, no data around. Only what is needed to run the platform, safely and respectfully.</p>
        </div>
      </div>
    </section>

    <!-- Footer -->
    

    <!-- Libreria Supabase (UMD) -->
    <script src="https://unpkg.com/@supabase/supabase-js"></script>

    <!-- Aggiorna contatori in tempo reale (Supabase) -->
    <script type="module" src="/script-realtime.js"></script>

    <!-- Modulo principale per Vite (dev) -->
    <script type="module" src="/src/main.js"></script>
    <script defer src="/scripts/header-menu.js"></script>
    <script type="module" src="/src/ui/lang-toggle.js"></script>
    <script type="module" src="/scripts/inject-footer.js"></script>
</body>
</html> 